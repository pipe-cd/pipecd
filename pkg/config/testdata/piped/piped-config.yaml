apiVersion: pipecd.dev/v1beta1
kind: Piped
spec:
  syncInterval: 1m

  git:
    username: username
    email: username@email.com
    sshKeyFile: /etc/piped-secret/git-ssh-key
    accessTokenFile: /etc/piped-secret/git-access-token

  repositories:
    - repoId: repo1
      remote: git@github.com:org/repo1.git
      branch: master
    - repoId: repo2
      remote: git@github.com:org/repo2.git
      branch: master

  cloudProviders:
    - name: kubernetes-default
      type: KUBERNETES
      watchingResources:
        - apiVersion: kapetanios.dev/v1beta1
        - apiVersion: networking.gke.io/v1beta1
          kind: ManagedCertificate
      ignoreWatchingResources:
        - apiVersion: v1
          kind: Endpoints

    - name: terraform-gcp
      type: TERRAFORM
      config:
        gcp:
          project: gcp-project
          region: us-central1
          credentialsFile: /etc/piped-secret/gcp-service-account.json

    - name: terraform-aws
      type: TERRAFORM
      config:
        aws:
          region: us-east-1

    - name: cloudrun
      type: CLOUDRUN
      config:
        project: gcp-project
        region: us-east-1
        platform: managed
        credentialsFile: /etc/piped-secret/gcp-service-account.json

    - name: lambda
      type: LAMBDA
      config:
        region: us-east-1

  analysisProviders:
    - name: prometheus-dev
      type: PROMETHEUS
      config:
        address: https://your-prometheus.dev
    - name: datadog-dev
      type: DATADOG
      config:
        address: https://your-datadog.dev
        apiKeyFile: /etc/piped-secret/datadog-api-key
        applicationKeyFile: /etc/piped-secret/datadog-application-key
    - name: stackdriver-dev
      type: STACKDRIVER
      config:
        serviceAccountFile: /etc/piped-secret/gcp-service-account.json
